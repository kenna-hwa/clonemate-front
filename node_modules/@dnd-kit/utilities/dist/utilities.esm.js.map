{"version":3,"file":"utilities.esm.js","sources":["../src/hooks/useCombinedRefs.ts","../src/execution-context/canUseDOM.ts","../src/type-guards/isWindow.ts","../src/type-guards/isNode.ts","../src/execution-context/getWindow.ts","../src/type-guards/isDocument.ts","../src/type-guards/isHTMLElement.ts","../src/type-guards/isSVGElement.ts","../src/execution-context/getOwnerDocument.ts","../src/hooks/useIsomorphicLayoutEffect.ts","../src/hooks/useInterval.ts","../src/hooks/useLatestValue.ts","../src/hooks/useLazyMemo.ts","../src/hooks/useNodeRef.ts","../src/hooks/useUniqueId.ts","../src/adjustment.ts","../src/event/hasViewportRelativeCoordinates.ts","../src/event/isKeyboardEvent.ts","../src/event/isTouchEvent.ts","../src/coordinates/getEventCoordinates.ts","../src/css.ts"],"sourcesContent":["import {useMemo} from 'react';\n\nexport function useCombinedRefs<T>(\n  ...refs: ((node: T) => void)[]\n): (node: T) => void {\n  return useMemo(\n    () => (node: T) => {\n      refs.forEach((ref) => ref(node));\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    refs\n  );\n}\n","// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const canUseDOM =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined';\n","export function isWindow(element: Object): element is typeof window {\n  const elementString = Object.prototype.toString.call(element);\n  return (\n    elementString === '[object Window]' ||\n    // In Electron context the Window object serializes to [object global]\n    elementString === '[object global]'\n  );\n}\n","export function isNode(node: Object): node is Node {\n  return 'nodeType' in node;\n}\n","import {isWindow} from '../type-guards/isWindow';\nimport {isNode} from '../type-guards/isNode';\n\nexport function getWindow(target: Event['target']): typeof window {\n  if (!target) {\n    return window;\n  }\n\n  if (isWindow(target)) {\n    return target;\n  }\n\n  if (!isNode(target)) {\n    return window;\n  }\n\n  return target.ownerDocument?.defaultView ?? window;\n}\n","import {getWindow} from '../execution-context/getWindow';\n\nexport function isDocument(node: Node): node is Document {\n  const {Document} = getWindow(node);\n\n  return node instanceof Document;\n}\n","import {getWindow} from '../execution-context/getWindow';\n\nimport {isWindow} from './isWindow';\n\nexport function isHTMLElement(node: Node | Window): node is HTMLElement {\n  if (isWindow(node)) {\n    return false;\n  }\n\n  return node instanceof getWindow(node).HTMLElement;\n}\n","import {getWindow} from '../execution-context/getWindow';\n\nexport function isSVGElement(node: Node): node is SVGElement {\n  return node instanceof getWindow(node).SVGElement;\n}\n","import {isWindow, isHTMLElement, isDocument, isNode} from '../type-guards';\n\nexport function getOwnerDocument(target: Event['target']): Document {\n  if (!target) {\n    return document;\n  }\n\n  if (isWindow(target)) {\n    return target.document;\n  }\n\n  if (!isNode(target)) {\n    return document;\n  }\n\n  if (isDocument(target)) {\n    return target;\n  }\n\n  if (isHTMLElement(target)) {\n    return target.ownerDocument;\n  }\n\n  return document;\n}\n","import {useEffect, useLayoutEffect} from 'react';\n\nimport {canUseDOM} from '../execution-context';\n\n/**\n * A hook that resolves to useEffect on the server and useLayoutEffect on the client\n * @param callback {function} Callback function that is invoked when the dependencies of the hook change\n */\nexport const useIsomorphicLayoutEffect = canUseDOM\n  ? useLayoutEffect\n  : useEffect;\n","import {useCallback, useRef} from 'react';\n\nexport function useInterval() {\n  const intervalRef = useRef<number | null>(null);\n\n  const set = useCallback((listener: Function, duration: number) => {\n    intervalRef.current = setInterval(listener, duration);\n  }, []);\n\n  const clear = useCallback(() => {\n    if (intervalRef.current !== null) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n  }, []);\n\n  return [set, clear] as const;\n}\n","import {useRef} from 'react';\n\nimport {useIsomorphicLayoutEffect} from './useIsomorphicLayoutEffect';\n\nexport function useLatestValue<T extends any>(\n  value: T,\n  dependencies = [value]\n) {\n  const valueRef = useRef<T>(value);\n\n  useIsomorphicLayoutEffect(() => {\n    if (valueRef.current !== value) {\n      valueRef.current = value;\n    }\n  }, dependencies);\n\n  return valueRef;\n}\n","import {useMemo, useRef} from 'react';\n\nexport function useLazyMemo<T>(\n  callback: (prevValue: T | undefined) => T,\n  dependencies: any[]\n) {\n  const valueRef = useRef<T>();\n\n  return useMemo(\n    () => {\n      const newValue = callback(valueRef.current);\n      valueRef.current = newValue;\n\n      return newValue;\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [...dependencies]\n  );\n}\n","import {useRef, useCallback} from 'react';\n\nimport {useLatestValue} from './useLatestValue';\n\nexport function useNodeRef(\n  onChange?: (\n    newElement: HTMLElement | null,\n    previousElement: HTMLElement | null\n  ) => void\n) {\n  const onChangeRef = useLatestValue(onChange);\n  const node = useRef<HTMLElement | null>(null);\n  const setNodeRef = useCallback(\n    (element: HTMLElement | null) => {\n      if (element !== node.current) {\n        onChangeRef.current?.(element, node.current);\n      }\n\n      node.current = element;\n    },\n    //eslint-disable-next-line\n    []\n  );\n\n  return [node, setNodeRef] as const;\n}\n","import {useMemo} from 'react';\n\nlet ids: Record<string, number> = {};\n\nexport function useUniqueId(prefix: string, value?: string) {\n  return useMemo(() => {\n    if (value) {\n      return value;\n    }\n\n    const id = ids[prefix] == null ? 0 : ids[prefix] + 1;\n    ids[prefix] = id;\n\n    return `${prefix}-${id}`;\n  }, [prefix, value]);\n}\n","function createAdjustmentFn(modifier: number) {\n  return <T extends Record<U, number>, U extends string>(\n    object: T,\n    ...adjustments: Partial<T>[]\n  ): T => {\n    return adjustments.reduce<T>(\n      (accumulator, adjustment) => {\n        const entries = Object.entries(adjustment) as [U, number][];\n\n        for (const [key, valueAdjustment] of entries) {\n          const value = accumulator[key];\n\n          if (value != null) {\n            accumulator[key] = (value + modifier * valueAdjustment) as T[U];\n          }\n        }\n\n        return accumulator;\n      },\n      {\n        ...object,\n      }\n    );\n  };\n}\n\nexport const add = createAdjustmentFn(1);\nexport const subtract = createAdjustmentFn(-1);\n","export function hasViewportRelativeCoordinates(\n  event: Event\n): event is Event & Pick<PointerEvent, 'clientX' | 'clientY'> {\n  return 'clientX' in event && 'clientY' in event;\n}\n","import {getWindow} from '../execution-context';\n\nexport function isKeyboardEvent(\n  event: Event | undefined | null\n): event is KeyboardEvent {\n  if (!event) {\n    return false;\n  }\n\n  const {KeyboardEvent} = getWindow(event.target);\n\n  return KeyboardEvent && event instanceof KeyboardEvent;\n}\n","import {getWindow} from '../execution-context';\n\nexport function isTouchEvent(\n  event: Event | undefined | null\n): event is TouchEvent {\n  if (!event) {\n    return false;\n  }\n\n  const {TouchEvent} = getWindow(event.target);\n\n  return TouchEvent && event instanceof TouchEvent;\n}\n","import type {Coordinates} from './types';\nimport {isTouchEvent, hasViewportRelativeCoordinates} from '../event';\n\n/**\n * Returns the normalized x and y coordinates for mouse and touch events.\n */\nexport function getEventCoordinates(event: Event): Coordinates | null {\n  if (isTouchEvent(event)) {\n    if (event.touches && event.touches.length) {\n      const {clientX: x, clientY: y} = event.touches[0];\n\n      return {\n        x,\n        y,\n      };\n    } else if (event.changedTouches && event.changedTouches.length) {\n      const {clientX: x, clientY: y} = event.changedTouches[0];\n\n      return {\n        x,\n        y,\n      };\n    }\n  }\n\n  if (hasViewportRelativeCoordinates(event)) {\n    return {\n      x: event.clientX,\n      y: event.clientY,\n    };\n  }\n\n  return null;\n}\n","export type Transform = {\n  x: number;\n  y: number;\n  scaleX: number;\n  scaleY: number;\n};\n\nexport interface Transition {\n  property: string;\n  easing: string;\n  duration: number;\n}\n\nexport const CSS = Object.freeze({\n  Translate: {\n    toString(transform: Transform | null) {\n      if (!transform) {\n        return;\n      }\n\n      const {x, y} = transform;\n\n      return `translate3d(${x ? Math.round(x) : 0}px, ${\n        y ? Math.round(y) : 0\n      }px, 0)`;\n    },\n  },\n  Scale: {\n    toString(transform: Transform | null) {\n      if (!transform) {\n        return;\n      }\n\n      const {scaleX, scaleY} = transform;\n\n      return `scaleX(${scaleX}) scaleY(${scaleY})`;\n    },\n  },\n  Transform: {\n    toString(transform: Transform | null) {\n      if (!transform) {\n        return;\n      }\n\n      return [\n        CSS.Translate.toString(transform),\n        CSS.Scale.toString(transform),\n      ].join(' ');\n    },\n  },\n  Transition: {\n    toString({property, duration, easing}: Transition) {\n      return `${property} ${duration}ms ${easing}`;\n    },\n  },\n});\n"],"names":["useCombinedRefs","refs","useMemo","node","forEach","ref","canUseDOM","window","document","createElement","isWindow","element","elementString","Object","prototype","toString","call","isNode","getWindow","target","ownerDocument","defaultView","isDocument","Document","isHTMLElement","HTMLElement","isSVGElement","SVGElement","getOwnerDocument","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useInterval","intervalRef","useRef","set","useCallback","listener","duration","current","setInterval","clear","clearInterval","useLatestValue","value","dependencies","valueRef","useLazyMemo","callback","newValue","useNodeRef","onChange","onChangeRef","setNodeRef","ids","useUniqueId","prefix","id","createAdjustmentFn","modifier","object","adjustments","reduce","accumulator","adjustment","entries","key","valueAdjustment","add","subtract","hasViewportRelativeCoordinates","event","isKeyboardEvent","KeyboardEvent","isTouchEvent","TouchEvent","getEventCoordinates","touches","length","clientX","x","clientY","y","changedTouches","CSS","freeze","Translate","transform","Math","round","Scale","scaleX","scaleY","Transform","join","Transition","property","easing"],"mappings":"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"}